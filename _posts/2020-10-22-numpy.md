---
layout: posts
title: Numpy
comments: true
categories: Numpy
---

## Numpy
Pandas 및 OpenCV와 같은 이미지 처리 라이브러리

1. 설치
```python
pip3 install numpy
```

2. jupyter 실행
```bash
jupyter notebook
```

3. 배열 생성
- 1차원 배열 생성   

```python
import numpy
n=numpy.arrang(27)

# 값
n
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26])

# 출력
print(n)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26]

# type
type(n)
numpy.ndarray
```

- 2차원 배열    
```python
# 3x9 배열 생성
n.reshape(3,9)
array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8],
       [ 9, 10, 11, 12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23, 24, 25, 26]])
```

- 3차원 배열    
```python
n.reshape(3,3,3)
array([[[ 0,  1,  2],
        [ 3,  4,  5],
        [ 6,  7,  8]],

       [[ 9, 10, 11],
        [12, 13, 14],
        [15, 16, 17]],

       [[18, 19, 20],
        [21, 22, 23],
        [24, 25, 26]]])
```

- `numpy.asarray`   
numpy 배열 만들기   
       ```python
       m=numpy.asarray(a=[[123,12,123,12,33],[],[]])

       # 출력
       m
       array([list([123, 12, 123, 12, 33]), list([]), list([])], dtype=object)

       print(m)
       [list([123, 12, 123, 12, 33]) list([]) list([])

       # 타입 확인
       type(m)
       numpy.ndarray
       ```

## OpenCV 설치
```bash
pip3 install opencv-python

# 확인
python3
>>> import cv2

# 에러가 없다면 정상 설치됨.
```

## Image를 Numpy 배열로 변환
1. 이미지 읽기   
파일 준비 : smallgray.png
       ```python
       # opencv 로드
       import cv2

       # 이미지를 numpy 배열로 변환(흑백)
       im_g=cv2.imread("smallgray.png",0)
       array([[187, 158, 104, 121, 143],
              [198, 125, 255, 255, 147],
              [209, 134, 255,  97, 182]], dtype=uint8)

       # 컬러(BGR)
       im_g=cv2.imread("smallgray.png",1)
       array([[[187, 187, 187],
              [158, 158, 158],
              [104, 104, 104],
              [121, 121, 121],
              [143, 143, 143]],

              [[198, 198, 198],
              [125, 125, 125],
              [255, 255, 255],
              [255, 255, 255],
              [147, 147, 147]],

              [[209, 209, 209],
              [134, 134, 134],
              [255, 255, 255],
              [ 97,  97,  97],
              [182, 182, 182]]], dtype=uint8)

       # 출력
       print(im_g)
       [[[187 187 187]
       [158 158 158]
       [104 104 104]
       [121 121 121]
       [143 143 143]]

       [[198 198 198]
       [125 125 125]
       [255 255 255]
       [255 255 255]
       [147 147 147]]

       [[209 209 209]
       [134 134 134]
       [255 255 255]
       [ 97  97  97]
       [182 182 182]]]
       ```

2. 이미지 생성
- numpy 배열로 이미지 생성   
```python
cv2.imwrite("newsmallgray.png",im_g)
```

## Numpy 배열 다루기
### Slicing
```python
im_g=cv2.imread("smallgray.png",0)
print(im_g)
[[187 158 104 121 143]
 [198 125 255 255 147]
 [209 134 255  97 182]]

 # 1행,2행 출력
 im_g[0:2]
 array([[187, 158, 104, 121, 143],
       [198, 125, 255, 255, 147]], dtype=uint8)

# 1행,2행 및 3열,4열 출력
im_g[0:2,2:4]
array([[104, 121],
       [255, 255]], dtype=uint8)

# 크기 확인
im_g.shape
(3, 5)

# 3열,4열 출력
im_g[:,2:4]
array([[104, 121],
       [255, 255],
       [255,  97]], dtype=uint8)
```

### Iterating
```python
# 행 출력
for i in im_g:
    print(i)
[187 158 104 121 143]
[198 125 255 255 147]
[209 134 255  97 182]

# 열 출력
for i in im_g.T:
    print(i)
[187 198 209]
[158 125 134]
[104 255 255]
[121 255  97]
[143 147 182]

# 하나씩 출력
for i in im_g.flat:
    print(i)
```

### Stacking and Splitting
1. Stacking   
```python
# 수평(옆으로) 병합
ims=numpy.hstack((im_g,im_g))
print(ims)
[[187 158 104 121 143 187 158 104 121 143 187 158 104 121 143]
 [198 125 255 255 147 198 125 255 255 147 198 125 255 255 147]
 [209 134 255  97 182 209 134 255  97 182 209 134 255  97 182]]

# 수직(아래로) 병합
ims=numpy.vstack((im_g,im_g))
ims
array([[187, 158, 104, 121, 143],
       [198, 125, 255, 255, 147],
       [209, 134, 255,  97, 182],
       [187, 158, 104, 121, 143],
       [198, 125, 255, 255, 147],
       [209, 134, 255,  97, 182],
       [187, 158, 104, 121, 143],
       [198, 125, 255, 255, 147],
       [209, 134, 255,  97, 182]], dtype=uint8)
```

2. Splitting   
```python
# 수평(열)로 자르기
lst=numpy.hsplit(ims,5)
[array([[187],
        [198],
        [209],
        [187],
        [198],
        [209],
        [187],
        [198],
        [209]], dtype=uint8),
 array([[158],
        [125],
        [134],
        [158],
        [125],
        [134],
        [158],
        [125],
        [134]], dtype=uint8),
 array([[104],
        [255],
        [255],
        [104],
        [255],
        [255],
        [104],
        [255],
        [255]], dtype=uint8),
 array([[121],
        [255],
        [ 97],
        [121],
        [255],
        [ 97],
        [121],
        [255],
        [ 97]], dtype=uint8),
 array([[143],
        [147],
        [182],
        [143],
        [147],
        [182],
        [143],
        [147],
        [182]], dtype=uint8)]

# 수직(행)으로 자르기
lst=numpy.vsplit(ims,3)
[array([[187, 158, 104, 121, 143],
        [198, 125, 255, 255, 147],
        [209, 134, 255,  97, 182]], dtype=uint8),
 array([[187, 158, 104, 121, 143],
        [198, 125, 255, 255, 147],
        [209, 134, 255,  97, 182]], dtype=uint8),
 array([[187, 158, 104, 121, 143],
        [198, 125, 255, 255, 147],
        [209, 134, 255,  97, 182]], dtype=uint8)]

# 타입은 리스트
type(lst)
list

# 첫번재 index 값
lst[0]
array([[187, 158, 104, 121, 143],
       [198, 125, 255, 255, 147],
       [209, 134, 255,  97, 182]], dtype=uint8)
```

